var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function r(t){return"function"==typeof t}function a(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}let s,c;function i(t,n){return s||(s=document.createElement("a")),s.href=n,t===s.href}function u(t,n){t.appendChild(n)}function l(t,n,e){t.insertBefore(n,e||null)}function f(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function g(){return h(" ")}function p(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function v(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function $(t){return""===t?null:+t}function m(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}function y(t,n){t.value=null==n?"":n}function x(t){c=t}const w=[],k=[],C=[],b=[],_=Promise.resolve();let A=!1;function E(t){C.push(t)}function I(t){b.push(t)}const j=new Set;let M=0;function T(){const t=c;do{for(;M<w.length;){const t=w[M];M++,x(t),H(t.$$)}for(x(null),w.length=0,M=0;k.length;)k.pop()();for(let t=0;t<C.length;t+=1){const n=C[t];j.has(n)||(j.add(n),n())}C.length=0}while(w.length);for(;b.length;)b.pop()();A=!1,j.clear(),x(t)}function H(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(E)}}const L=new Set;function O(t,n){t&&t.i&&(L.delete(t),t.i(n))}function P(t,n,e,o){if(t&&t.o){if(L.has(t))return;L.add(t),undefined.c.push((()=>{L.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}else o&&o()}function D(t,n,e){const o=t.$$.props[n];void 0!==o&&(t.$$.bound[o]=e,e(t.$$.ctx[o]))}function N(t){t&&t.c()}function S(t,e,a,s){const{fragment:c,on_mount:i,on_destroy:u,after_update:l}=t.$$;c&&c.m(e,a),s||E((()=>{const e=i.map(n).filter(r);u?u.push(...e):o(e),t.$$.on_mount=[]})),l.forEach(E)}function z(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function R(t,n){-1===t.$$.dirty[0]&&(w.push(t),A||(A=!0,_.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function W(n,r,a,s,i,u,l,d=[-1]){const h=c;x(n);const g=n.$$={fragment:null,ctx:null,props:u,update:t,not_equal:i,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(h?h.$$.context:[])),callbacks:e(),dirty:d,skip_bound:!1,root:r.target||h.$$.root};l&&l(g.root);let p=!1;if(g.ctx=a?a(n,r.props||{},((t,e,...o)=>{const r=o.length?o[0]:e;return g.ctx&&i(g.ctx[t],g.ctx[t]=r)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](r),p&&R(n,t)),e})):[],g.update(),p=!0,o(g.before_update),g.fragment=!!s&&s(g.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);g.fragment&&g.fragment.l(t),t.forEach(f)}else g.fragment&&g.fragment.c();r.intro&&O(n.$$.fragment),S(n,r.target,r.anchor,r.customElement),T()}x(h)}class q{$destroy(){z(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function B(n){let e;return{c(){e=d("canvas"),v(e,"class","svelte-g447h4")},m(t,o){l(t,e,o),n[1](e)},p:t,i:t,o:t,d(t){t&&f(e),n[1](null)}}}function F(t,n,e){let{canvas:o}=n;return t.$$set=t=>{"canvas"in t&&e(0,o=t.canvas)},[o,function(t){k[t?"unshift":"push"]((()=>{o=t,e(0,o)}))}]}class G extends q{constructor(t){super(),W(this,t,F,B,a,{canvas:0})}}function U(n){let e;return{c(){e=d("canvas"),v(e,"width",0),v(e,"height",0),v(e,"class","svelte-gkygfa")},m(t,o){l(t,e,o),n[1](e)},p:t,i:t,o:t,d(t){t&&f(e),n[1](null)}}}function V(t,n,e){let{canvas:o}=n;return t.$$set=t=>{"canvas"in t&&e(0,o=t.canvas)},[o,function(t){k[t?"unshift":"push"]((()=>{o=t,e(0,o)}))}]}class J extends q{constructor(t){super(),W(this,t,V,U,a,{canvas:0})}}const K=(t,n,e)=>{const o=t.getContext("2d").getImageData(0,0,t.width,t.height),r=[];for(const n of Array(t.height).keys())for(const e of Array(t.width).keys()){const a=4*(n*t.width+e);r.push([o.data[a+0],o.data[a+1],o.data[a+2]])}let a=((t,n)=>{n=n||1,t=t.slice();const e=[];for(const o of Array(n).keys()){const n=Math.floor(Math.random()*t.length);e[o]=t[n],t.splice(n,1)}return e})(r,e),s=[];for(const t of Array(10).keys()){s=[];for(const t of r){const n=[];for(const e of a)n.push((i=e,((c=t)[0]-i[0])**2+(c[1]-i[1])**2+(c[2]-i[2])**2));s.push(n.indexOf(Math.min(...n)))}const t=[...Array(e).keys()].map((t=>s.filter((n=>n==t)).length)),n=[...Array(e).keys()].map((t=>[0,0,0]));for(const e of Array(r.length).keys())n[s[e]][0]+=r[e][0]/t[s[e]],n[s[e]][1]+=r[e][1]/t[s[e]],n[s[e]][2]+=r[e][2]/t[s[e]];a=n}var c,i;for(const n of Array(t.height).keys())for(const e of Array(t.width).keys()){const r=4*(n*t.width+e);o.data[r+0]=a[s[n*t.width+e]][0],o.data[r+1]=a[s[n*t.width+e]][1],o.data[r+2]=a[s[n*t.width+e]][2],o.data[r+3]=255}n.getContext("2d").putImageData(o,0,0)};function Q(n){let e,o,r;return{c(){e=d("button"),e.textContent="Convert"},m(t,a){l(t,e,a),o||(r=p(e,"click",n[0]),o=!0)},p:t,i:t,o:t,d(t){t&&f(e),o=!1,r()}}}function X(t,n,e){let{originalCanvas:o}=n,{convertedCanvas:r}=n,{k:a}=n;return t.$$set=t=>{"originalCanvas"in t&&e(1,o=t.originalCanvas),"convertedCanvas"in t&&e(2,r=t.convertedCanvas),"k"in t&&e(3,a=t.k)},[()=>{K(o,r,a)},o,r,a]}class Y extends q{constructor(t){super(),W(this,t,X,Q,a,{originalCanvas:1,convertedCanvas:2,k:3})}}function Z(t){let n,e,r,a,s,c,$,x,w,C,b,_,A,E,j,M,T,H,L,R,W,q,B,F,U,V,K,Q,X,Z,tt,nt,et,ot,rt,at,st,ct,it,ut,lt,ft,dt,ht,gt,pt,vt,$t,mt,yt,xt,wt,kt;function Ct(n){t[10](n)}U=new Y({props:{originalCanvas:t[1],convertedCanvas:t[3],k:t[4]}});let bt={};function _t(n){t[11](n)}void 0!==t[1]&&(bt.canvas=t[1]),et=new G({props:bt}),k.push((()=>D(et,"canvas",Ct)));let At={};return void 0!==t[3]&&(At.canvas=t[3]),at=new J({props:At}),k.push((()=>D(at,"canvas",_t))),{c(){n=d("main"),e=d("h1"),e.textContent="Pixel Art Converter",r=g(),a=d("p"),a.textContent="k-means法を用いたドット絵コンバーターです。初期値を乱数によって決定するため実行毎に結果が変わります。",s=g(),c=d("input"),$=g(),x=d("h2"),x.textContent="Parameter",w=g(),C=d("div"),b=d("p"),_=h("k="),A=h(t[4]),E=g(),j=d("input"),M=g(),T=d("div"),H=d("p"),L=h("downscale="),R=h(t[5]),W=g(),q=d("input"),B=g(),F=d("div"),N(U.$$.fragment),V=g(),K=d("h2"),K.textContent="Image",Q=g(),X=d("div"),Z=d("img"),nt=g(),N(et.$$.fragment),rt=g(),N(at.$$.fragment),ct=g(),it=d("h2"),it.textContent="Twitterでつぶやく",ut=g(),lt=d("p"),lt.textContent="画像は自動で挿入されません。ダウンロードまたはクリップボードにコピーしてから添付してください。",ft=g(),dt=d("ul"),ht=d("li"),gt=d("a"),pt=h("Tweet"),vt=g(),$t=d("h2"),$t.textContent="View on GitHub",mt=g(),yt=d("p"),yt.innerHTML='<a href="https://github.com/3w36zj6/pixel-art-converter"><img alt="pixel-art-converter" src="https://gh-card.dev/repos/3w36zj6/pixel-art-converter.svg" class="svelte-10yk6sv"/></a>',v(c,"type","file"),v(j,"type","range"),v(j,"min","2"),v(j,"max","32"),v(j,"class","svelte-10yk6sv"),v(q,"type","range"),v(q,"min","1"),v(q,"max","16"),v(q,"class","svelte-10yk6sv"),i(Z.src,tt=t[2])||v(Z,"src",tt),v(Z,"alt",""),v(Z,"class","svelte-10yk6sv"),v(gt,"href","https://twitter.com/intent/tweet?hashtags=pixelart&text=ドット絵コンバーター%20/%20Pixel%20Art%20Converter&url="+location.toString())},m(o,i){l(o,n,i),u(n,e),u(n,r),u(n,a),u(n,s),u(n,c),u(n,$),u(n,x),u(n,w),u(n,C),u(C,b),u(b,_),u(b,A),u(C,E),u(C,j),y(j,t[4]),u(n,M),u(n,T),u(T,H),u(H,L),u(H,R),u(T,W),u(T,q),y(q,t[5]),u(n,B),u(n,F),S(U,F,null),u(n,V),u(n,K),u(n,Q),u(n,X),u(X,Z),u(X,nt),S(et,X,null),u(X,rt),S(at,X,null),u(n,ct),u(n,it),u(n,ut),u(n,lt),u(n,ft),u(n,dt),u(dt,ht),u(ht,gt),u(gt,pt),u(n,vt),u(n,$t),u(n,mt),u(n,yt),xt=!0,wt||(kt=[p(c,"change",t[7]),p(c,"change",t[6]),p(j,"change",t[8]),p(j,"input",t[8]),p(j,"change",t[6]),p(q,"change",t[9]),p(q,"input",t[9]),p(q,"change",t[6])],wt=!0)},p(t,[n]){(!xt||16&n)&&m(A,t[4]),16&n&&y(j,t[4]),(!xt||32&n)&&m(R,t[5]),32&n&&y(q,t[5]);const e={};2&n&&(e.originalCanvas=t[1]),8&n&&(e.convertedCanvas=t[3]),16&n&&(e.k=t[4]),U.$set(e),(!xt||4&n&&!i(Z.src,tt=t[2]))&&v(Z,"src",tt);const o={};!ot&&2&n&&(ot=!0,o.canvas=t[1],I((()=>ot=!1))),et.$set(o);const r={};!st&&8&n&&(st=!0,r.canvas=t[3],I((()=>st=!1))),at.$set(r)},i(t){xt||(O(U.$$.fragment,t),O(et.$$.fragment,t),O(at.$$.fragment,t),xt=!0)},o(t){P(U.$$.fragment,t),P(et.$$.fragment,t),P(at.$$.fragment,t),xt=!1},d(t){t&&f(n),z(U),z(et),z(at),wt=!1,o(kt)}}}function tt(t,n,e){let o,r,a,s,c=4,i=4;return[o,r,a,s,c,i,()=>{const t=new FileReader;o&&o[0]&&(t.readAsDataURL(o[0]),t.onload=()=>{const n=new Image;n.src=t.result,n.onload=()=>{e(2,a=t.result),e(1,r.width=n.naturalWidth/i,r),e(1,r.height=n.naturalHeight/i,r),e(3,s.width=n.naturalWidth/i,s),e(3,s.height=n.naturalHeight/i,s);const o=r.getContext("2d"),u=s.getContext("2d");o.drawImage(n,0,0,r.width,r.height),u.drawImage(n,0,0,r.width,r.height),K(r,s,c)}})},function(){o=this.files,e(0,o)},function(){c=$(this.value),e(4,c)},function(){i=$(this.value),e(5,i)},function(t){r=t,e(1,r)},function(t){s=t,e(3,s)}]}return new class extends q{constructor(t){super(),W(this,t,tt,Z,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
