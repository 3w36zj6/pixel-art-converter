var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function r(t){return"function"==typeof t}function a(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}let s,c;function i(t,n){return s||(s=document.createElement("a")),s.href=n,t===s.href}function u(t,n){t.appendChild(n)}function l(t,n,e){t.insertBefore(n,e||null)}function f(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function p(){return d(" ")}function g(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function v(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function $(t){return""===t?null:+t}function m(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}function x(t,n){t.value=null==n?"":n}function w(t){c=t}const y=[],C=[],b=[],k=[],_=Promise.resolve();let A=!1;function E(t){b.push(t)}function j(t){k.push(t)}const I=new Set;let M=0;function O(){const t=c;do{for(;M<y.length;){const t=y[M];M++,w(t),P(t.$$)}for(w(null),y.length=0,M=0;C.length;)C.pop()();for(let t=0;t<b.length;t+=1){const n=b[t];I.has(n)||(I.add(n),n())}b.length=0}while(y.length);for(;k.length;)k.pop()();A=!1,I.clear(),w(t)}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(E)}}const T=new Set;function H(t,n){t&&t.i&&(T.delete(t),t.i(n))}function L(t,n,e,o){if(t&&t.o){if(T.has(t))return;T.add(t),undefined.c.push((()=>{T.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}else o&&o()}function D(t,n,e){const o=t.$$.props[n];void 0!==o&&(t.$$.bound[o]=e,e(t.$$.ctx[o]))}function N(t){t&&t.c()}function S(t,e,a,s){const{fragment:c,on_mount:i,on_destroy:u,after_update:l}=t.$$;c&&c.m(e,a),s||E((()=>{const e=i.map(n).filter(r);u?u.push(...e):o(e),t.$$.on_mount=[]})),l.forEach(E)}function z(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function R(t,n){-1===t.$$.dirty[0]&&(y.push(t),A||(A=!0,_.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function W(n,r,a,s,i,u,l,h=[-1]){const d=c;w(n);const p=n.$$={fragment:null,ctx:null,props:u,update:t,not_equal:i,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(d?d.$$.context:[])),callbacks:e(),dirty:h,skip_bound:!1,root:r.target||d.$$.root};l&&l(p.root);let g=!1;if(p.ctx=a?a(n,r.props||{},((t,e,...o)=>{const r=o.length?o[0]:e;return p.ctx&&i(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),g&&R(n,t)),e})):[],p.update(),g=!0,o(p.before_update),p.fragment=!!s&&s(p.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);p.fragment&&p.fragment.l(t),t.forEach(f)}else p.fragment&&p.fragment.c();r.intro&&H(n.$$.fragment),S(n,r.target,r.anchor,r.customElement),O()}w(d)}class q{$destroy(){z(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function B(n){let e;return{c(){e=h("canvas"),v(e,"class","svelte-g447h4")},m(t,o){l(t,e,o),n[1](e)},p:t,i:t,o:t,d(t){t&&f(e),n[1](null)}}}function F(t,n,e){let{canvas:o}=n;return t.$$set=t=>{"canvas"in t&&e(0,o=t.canvas)},[o,function(t){C[t?"unshift":"push"]((()=>{o=t,e(0,o)}))}]}class G extends q{constructor(t){super(),W(this,t,F,B,a,{canvas:0})}}function U(n){let e;return{c(){e=h("canvas"),v(e,"width",0),v(e,"height",0),v(e,"class","svelte-gkygfa")},m(t,o){l(t,e,o),n[1](e)},p:t,i:t,o:t,d(t){t&&f(e),n[1](null)}}}function V(t,n,e){let{canvas:o}=n;return t.$$set=t=>{"canvas"in t&&e(0,o=t.canvas)},[o,function(t){C[t?"unshift":"push"]((()=>{o=t,e(0,o)}))}]}class J extends q{constructor(t){super(),W(this,t,V,U,a,{canvas:0})}}Object.defineProperties(Array.prototype,{count:{value:function(t){return this.filter((n=>n==t)).length}}});const K=(t,n,e)=>{const o=t.getContext("2d").getImageData(0,0,t.width,t.height),r=[];for(let n=0;n<t.height;n++)for(let e=0;e<t.width;e++){const a=4*(n*t.width+e);r.push([o.data[a+0],o.data[a+1],o.data[a+2]])}let a=((t,n)=>{n=n||1,t=t.slice();const e=[];for(var o=0;o<n;o++){var r=Math.floor(Math.random()*t.length);e[o]=t[r],t.splice(r,1)}return e})(r,e),s=[];for(const t of[...Array(10).keys()]){s=[];for(const t of r){const n=[];for(const e of a)n.push((i=e,((c=t)[0]-i[0])**2+(c[1]-i[1])**2+(c[2]-i[2])**2));s.push(n.indexOf(Math.min(...n)))}let t=[...Array(e).keys()].map((t=>s.filter((n=>n==t)).length)),n=[...Array(e).keys()].map((t=>[0,0,0]));for(let e=0;e<r.length;e++)n[s[e]][0]+=r[e][0]/t[s[e]],n[s[e]][1]+=r[e][1]/t[s[e]],n[s[e]][2]+=r[e][2]/t[s[e]];a=n}var c,i;for(let n=0;n<t.height;n++)for(let e=0;e<t.width;e++){const r=4*(n*t.width+e);n*t.width+e<s.length&&(o.data[r+0]=a[s[n*t.width+e]][0],o.data[r+1]=a[s[n*t.width+e]][1],o.data[r+2]=a[s[n*t.width+e]][2],o.data[r+3]=255)}n.getContext("2d").putImageData(o,0,0)};function Q(n){let e,o,r;return{c(){e=h("button"),e.textContent="Convert"},m(t,a){l(t,e,a),o||(r=g(e,"click",n[0]),o=!0)},p:t,i:t,o:t,d(t){t&&f(e),o=!1,r()}}}function X(t,n,e){let{originalCanvas:o}=n,{convertedCanvas:r}=n,{k:a}=n;return t.$$set=t=>{"originalCanvas"in t&&e(1,o=t.originalCanvas),"convertedCanvas"in t&&e(2,r=t.convertedCanvas),"k"in t&&e(3,a=t.k)},[()=>{K(o,r,a)},o,r,a]}class Y extends q{constructor(t){super(),W(this,t,X,Q,a,{originalCanvas:1,convertedCanvas:2,k:3})}}function Z(t){let n,e,r,a,s,c,$,w,y,b,k,_,A,E,I,M,O,P,T,R,W,q,B,F,U,V,K,Q,X,Z,tt,nt,et,ot,rt,at,st,ct,it,ut,lt,ft,ht,dt,pt,gt,vt,$t,mt,xt,wt,yt,Ct;function bt(n){t[10](n)}U=new Y({props:{originalCanvas:t[1],convertedCanvas:t[3],k:t[4]}});let kt={};function _t(n){t[11](n)}void 0!==t[1]&&(kt.canvas=t[1]),et=new G({props:kt}),C.push((()=>D(et,"canvas",bt)));let At={};return void 0!==t[3]&&(At.canvas=t[3]),at=new J({props:At}),C.push((()=>D(at,"canvas",_t))),{c(){n=h("main"),e=h("h1"),e.textContent="Pixel Art Converter",r=p(),a=h("p"),a.textContent="k-means法を用いたドット絵コンバーターです。初期値を乱数によって決定するため実行毎に結果が変わります。",s=p(),c=h("input"),$=p(),w=h("h2"),w.textContent="Parameter",y=p(),b=h("div"),k=h("p"),_=d("k="),A=d(t[4]),E=p(),I=h("input"),M=p(),O=h("div"),P=h("p"),T=d("downscale="),R=d(t[5]),W=p(),q=h("input"),B=p(),F=h("div"),N(U.$$.fragment),V=p(),K=h("h2"),K.textContent="Image",Q=p(),X=h("div"),Z=h("img"),nt=p(),N(et.$$.fragment),rt=p(),N(at.$$.fragment),ct=p(),it=h("h2"),it.textContent="Twitterでつぶやく",ut=p(),lt=h("p"),lt.textContent="画像は自動で挿入されません。ダウンロードまたはクリップボードにコピーしてから添付してください。",ft=p(),ht=h("ul"),dt=h("li"),pt=h("a"),gt=d("Tweet"),vt=p(),$t=h("h2"),$t.textContent="View on GitHub",mt=p(),xt=h("p"),xt.innerHTML='<a href="https://github.com/3w36zj6/pixel-art-converter"><img alt="pixel-art-converter" src="https://gh-card.dev/repos/3w36zj6/pixel-art-converter.svg" class="svelte-10yk6sv"/></a>',v(c,"type","file"),v(I,"type","range"),v(I,"min","2"),v(I,"max","32"),v(I,"class","svelte-10yk6sv"),v(q,"type","range"),v(q,"min","1"),v(q,"max","16"),v(q,"class","svelte-10yk6sv"),i(Z.src,tt=t[2])||v(Z,"src",tt),v(Z,"alt",""),v(Z,"class","svelte-10yk6sv"),v(pt,"href","https://twitter.com/intent/tweet?hashtags=pixelart&text=ドット絵コンバーター%20/%20Pixel%20Art%20Converter&url="+location.toString())},m(o,i){l(o,n,i),u(n,e),u(n,r),u(n,a),u(n,s),u(n,c),u(n,$),u(n,w),u(n,y),u(n,b),u(b,k),u(k,_),u(k,A),u(b,E),u(b,I),x(I,t[4]),u(n,M),u(n,O),u(O,P),u(P,T),u(P,R),u(O,W),u(O,q),x(q,t[5]),u(n,B),u(n,F),S(U,F,null),u(n,V),u(n,K),u(n,Q),u(n,X),u(X,Z),u(X,nt),S(et,X,null),u(X,rt),S(at,X,null),u(n,ct),u(n,it),u(n,ut),u(n,lt),u(n,ft),u(n,ht),u(ht,dt),u(dt,pt),u(pt,gt),u(n,vt),u(n,$t),u(n,mt),u(n,xt),wt=!0,yt||(Ct=[g(c,"change",t[7]),g(c,"change",t[6]),g(I,"change",t[8]),g(I,"input",t[8]),g(I,"change",t[6]),g(q,"change",t[9]),g(q,"input",t[9]),g(q,"change",t[6])],yt=!0)},p(t,[n]){(!wt||16&n)&&m(A,t[4]),16&n&&x(I,t[4]),(!wt||32&n)&&m(R,t[5]),32&n&&x(q,t[5]);const e={};2&n&&(e.originalCanvas=t[1]),8&n&&(e.convertedCanvas=t[3]),16&n&&(e.k=t[4]),U.$set(e),(!wt||4&n&&!i(Z.src,tt=t[2]))&&v(Z,"src",tt);const o={};!ot&&2&n&&(ot=!0,o.canvas=t[1],j((()=>ot=!1))),et.$set(o);const r={};!st&&8&n&&(st=!0,r.canvas=t[3],j((()=>st=!1))),at.$set(r)},i(t){wt||(H(U.$$.fragment,t),H(et.$$.fragment,t),H(at.$$.fragment,t),wt=!0)},o(t){L(U.$$.fragment,t),L(et.$$.fragment,t),L(at.$$.fragment,t),wt=!1},d(t){t&&f(n),z(U),z(et),z(at),yt=!1,o(Ct)}}}function tt(t,n,e){let o,r,a,s,c=4,i=4;return[o,r,a,s,c,i,()=>{const t=new FileReader;o&&o[0]&&(t.readAsDataURL(o[0]),t.onload=()=>{const n=new Image;n.src=t.result,n.onload=()=>{e(2,a=t.result),e(1,r.width=n.naturalWidth/i,r),e(1,r.height=n.naturalHeight/i,r),e(3,s.width=n.naturalWidth/i,s),e(3,s.height=n.naturalHeight/i,s);const o=r.getContext("2d"),u=s.getContext("2d");o.drawImage(n,0,0,r.width,r.height),u.drawImage(n,0,0,r.width,r.height),K(r,s,c)}})},function(){o=this.files,e(0,o)},function(){c=$(this.value),e(4,c)},function(){i=$(this.value),e(5,i)},function(t){r=t,e(1,r)},function(t){s=t,e(3,s)}]}return new class extends q{constructor(t){super(),W(this,t,tt,Z,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
